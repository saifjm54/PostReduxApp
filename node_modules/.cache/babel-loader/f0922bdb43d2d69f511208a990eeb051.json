{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport { client } from '../../api/client';\nexport const fetchNotifications = createAsyncThunk('notifications/fetchNotifications', async (_, _ref) => {\n  let {\n    getState\n  } = _ref;\n  const allNotifications = selectAllNotifications(getState());\n  const [latestNotification] = allNotifications;\n  const latestTimestamp = latestNotification ? latestNotification.date : '';\n  const response = await client.get(`/fakeApi/notifications?since=${latestTimestamp}`);\n  return response.data;\n});\nconst notificationsSlice = createSlice({\n  name: 'notifications',\n  initialState: [],\n  reducers: {\n    allNotificationsRead(state, action) {\n      state.forEach(notification => {\n        notification.read = true;\n      });\n    }\n  },\n  extraReducers(builder) {\n    builder.addCase(fetchNotifications.fulfilled, (state, action) => {\n      state.push(...action.payload);\n      // Sort with newest first\n      state.forEach(notification => {\n        notification.isNew = !notification.read;\n      });\n      state.sort((a, b) => b.date.localeCompare(a.date));\n    });\n  }\n});\nexport const {\n  allNotificationsRead\n} = notificationsSlice.actions;\nexport default notificationsSlice.reducer;\nexport const selectAllNotifications = state => state.notifications;","map":{"version":3,"names":["createSlice","createAsyncThunk","client","fetchNotifications","_","_ref","getState","allNotifications","selectAllNotifications","latestNotification","latestTimestamp","date","response","get","data","notificationsSlice","name","initialState","reducers","allNotificationsRead","state","action","forEach","notification","read","extraReducers","builder","addCase","fulfilled","push","payload","isNew","sort","a","b","localeCompare","actions","reducer","notifications"],"sources":["/home/saif/Documents/Proxym/redux-essentials-example-app/src/features/notifications/notificationsSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit'\n\nimport { client } from '../../api/client'\n\nexport const fetchNotifications = createAsyncThunk(\n  'notifications/fetchNotifications',\n  async (_, { getState }) => {\n    const allNotifications = selectAllNotifications(getState())\n    const [latestNotification] = allNotifications\n    const latestTimestamp = latestNotification ? latestNotification.date : ''\n    const response = await client.get(\n      `/fakeApi/notifications?since=${latestTimestamp}`\n    )\n    return response.data\n  }\n)\n\n\nconst notificationsSlice = createSlice({\n  name: 'notifications',\n  initialState: [],\n  reducers: {\n    allNotificationsRead(state,action) {\n      state.forEach(notification => {\n        notification.read = true\n      })\n    }\n  },\n  extraReducers(builder) {\n    builder.addCase(fetchNotifications.fulfilled, (state, action) => {\n      state.push(...action.payload)\n      // Sort with newest first\n      state.forEach(notification => {\n        notification.isNew= !notification.read\n      })\n      state.sort((a, b) => b.date.localeCompare(a.date))\n    })\n  }\n})\n\nexport const { allNotificationsRead } = notificationsSlice.actions\nexport default notificationsSlice.reducer\n\nexport const selectAllNotifications = state => state.notifications"],"mappings":"AAAA,SAASA,WAAW,EAAEC,gBAAgB,QAAQ,kBAAkB;AAEhE,SAASC,MAAM,QAAQ,kBAAkB;AAEzC,OAAO,MAAMC,kBAAkB,GAAGF,gBAAgB,CAChD,kCAAkC,EAClC,OAAOG,CAAC,EAAAC,IAAA,KAAmB;EAAA,IAAjB;IAAEC;EAAS,CAAC,GAAAD,IAAA;EACpB,MAAME,gBAAgB,GAAGC,sBAAsB,CAACF,QAAQ,CAAC,CAAC,CAAC;EAC3D,MAAM,CAACG,kBAAkB,CAAC,GAAGF,gBAAgB;EAC7C,MAAMG,eAAe,GAAGD,kBAAkB,GAAGA,kBAAkB,CAACE,IAAI,GAAG,EAAE;EACzE,MAAMC,QAAQ,GAAG,MAAMV,MAAM,CAACW,GAAG,CAC9B,gCAA+BH,eAAgB,EAClD,CAAC;EACD,OAAOE,QAAQ,CAACE,IAAI;AACtB,CACF,CAAC;AAGD,MAAMC,kBAAkB,GAAGf,WAAW,CAAC;EACrCgB,IAAI,EAAE,eAAe;EACrBC,YAAY,EAAE,EAAE;EAChBC,QAAQ,EAAE;IACRC,oBAAoBA,CAACC,KAAK,EAACC,MAAM,EAAE;MACjCD,KAAK,CAACE,OAAO,CAACC,YAAY,IAAI;QAC5BA,YAAY,CAACC,IAAI,GAAG,IAAI;MAC1B,CAAC,CAAC;IACJ;EACF,CAAC;EACDC,aAAaA,CAACC,OAAO,EAAE;IACrBA,OAAO,CAACC,OAAO,CAACxB,kBAAkB,CAACyB,SAAS,EAAE,CAACR,KAAK,EAAEC,MAAM,KAAK;MAC/DD,KAAK,CAACS,IAAI,CAAC,GAAGR,MAAM,CAACS,OAAO,CAAC;MAC7B;MACAV,KAAK,CAACE,OAAO,CAACC,YAAY,IAAI;QAC5BA,YAAY,CAACQ,KAAK,GAAE,CAACR,YAAY,CAACC,IAAI;MACxC,CAAC,CAAC;MACFJ,KAAK,CAACY,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKA,CAAC,CAACvB,IAAI,CAACwB,aAAa,CAACF,CAAC,CAACtB,IAAI,CAAC,CAAC;IACpD,CAAC,CAAC;EACJ;AACF,CAAC,CAAC;AAEF,OAAO,MAAM;EAAEQ;AAAqB,CAAC,GAAGJ,kBAAkB,CAACqB,OAAO;AAClE,eAAerB,kBAAkB,CAACsB,OAAO;AAEzC,OAAO,MAAM7B,sBAAsB,GAAGY,KAAK,IAAIA,KAAK,CAACkB,aAAa"},"metadata":{},"sourceType":"module"}